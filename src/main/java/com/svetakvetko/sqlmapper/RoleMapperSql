<mapper namespace="com.svetakvetko.mapper.RoleMapper">

    <select id="getRolesById" parameterType="java.lang.Long" resultMap="roleList">
        SELECT "webapp"."role".id, "webapp"."role".rolename FROM "webapp"."user_roles"
        INNER JOIN "webapp"."USER" ON ("webapp"."USER".userid="webapp"."user_roles".user_id)
        INNER JOIN "webapp"."role" ON ("webapp"."role".id="webapp"."user_roles".role_id)
        WHERE user_id=#{userId}
    </select>

    <select id="getRolesByLogin" parameterType="java.lang.String" resultMap="roleList">
        SELECT "webapp"."role".id, "webapp"."role".rolename FROM "webapp"."user_roles"
        INNER JOIN "webapp"."USER" ON ("webapp"."USER".userid="webapp"."user_roles".user_id)
        INNER JOIN "webapp"."role" ON ("webapp"."role".id="webapp"."user_roles".role_id)
        WHERE webapp.USER.userLogin=#{userLogin}
    </select>

    <select id="getAllPossibleRoles" resultMap="roleList">
        SELECT * FROM "webapp"."role"
    </select>

    <delete id="deleteRole" parameterType="java.util.Map">
        DELETE FROM "webapp"."user_roles" where user_id=#{userId} AND role_id=#{roleId}
    </delete>

    <insert id="addRole" parameterType="java.util.Map">
        INSERT INTO \"webapp\".\"user_roles\" ( user_id, role_id) VALUES (#{userId},#{roleId})
    </insert>

    <resultMap id="role" type="com.svetakvetko.domain.Role">
        <result column="rolename" property="roleName"/>
        <result column="roleid" property="id"/>
    </resultMap>

    <resultMap id="roleList" type="com.svetakvetko.domain.Role">
        <collection javaType="ArrayList"  resultMap="role"/>
    </resultMap>

</mapper>